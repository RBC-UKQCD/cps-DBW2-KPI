#include<config.h>
CPS_START_NAMESPACE
/*w_gamma_mat.h
 *define 4-D dirac matrices
 *Total memory used is about 4x4x2x10=0x140
 */

CPS_END_NAMESPACE
#include <alg/w_gamma_mat.h>
#include <util/data_types.h>
CPS_START_NAMESPACE

// follow definition of gamma[i] in Ping's thesis
// and WGamma[n]= g1^n1 + g2^n2 + g3^n3 +g4^n4
// n = n1 + 2*n2 + 4*n3 + 8*n4 
// checked with maple: dirac.ms  (Thomas, May 11 2000)

// G0
IFloat WGamma[16][4][4][2]={1.0,0.0,  0.0,0.0,  0.0,0.0,  0.0,0.0, 
		       	   0.0,0.0,  1.0,0.0,  0.0,0.0,  0.0,0.0, 
			   0.0,0.0,  0.0,0.0,  1.0,0.0,  0.0,0.0, 
			   0.0,0.0,  0.0,0.0,  0.0,0.0,  1.0,0.0,

			   // G1
			   0.0, 0.0,  0.0, 0.0,  0.0,0.0,  0.0,1.0,
			   0.0, 0.0,  0.0, 0.0,  0.0,1.0,  0.0,0.0,
			   0.0, 0.0,  0.0,-1.0,  0.0,0.0,  0.0,0.0,
			   0.0,-1.0,  0.0, 0.0,  0.0,0.0,  0.0,0.0,

			   // G2
			   0.0,0.0,  0.0,0.0,  0.0,0.0, -1.0,0.0,
			   0.0,0.0,  0.0,0.0,  1.0,0.0,  0.0,0.0,
			   0.0,0.0,  1.0,0.0,  0.0,0.0,  0.0,0.0,
		          -1.0,0.0,  0.0,0.0,  0.0,0.0,  0.0,0.0,

			   // g3g4g5 = -g1g2 = -G3
			   0.0,-1.0,  0.0, 0.0,  0.0, 0.0,  0.0, 0.0,
			   0.0, 0.0,  0.0, 1.0,  0.0, 0.0,  0.0, 0.0,
			   0.0, 0.0,  0.0, 0.0,  0.0,-1.0,  0.0, 0.0,
			   0.0, 0.0,  0.0, 0.0,  0.0, 0.0,  0.0, 1.0,

			   // G4
			   0.0, 0.0,  0.0,0.0,  0.0,1.0,  0.0, 0.0,
			   0.0, 0.0,  0.0,0.0,  0.0,0.0,  0.0,-1.0,
			   0.0,-1.0,  0.0,0.0,  0.0,0.0,  0.0, 0.0,
			   0.0, 0.0,  0.0,1.0,  0.0,0.0,  0.0, 0.0,


			   // g2g4g5 = g1g3 = G[5]
			   0.0,0.0,  -1.0,0.0,  0.0,0.0,   0.0,0.0,
			   1.0,0.0,   0.0,0.0,  0.0,0.0,   0.0,0.0,
			   0.0,0.0,   0.0,0.0,  0.0,0.0,  -1.0,0.0,
			   0.0,0.0,   0.0,0.0,  1.0,0.0,   0.0,0.0,

			   // G[6] = g2g3 = -gamma1gamma4gamma5 = -g2g3
			   0.0, 0.0,  0.0,-1.0,  0.0, 0.0,  0.0, 0.0,
			   0.0,-1.0,  0.0, 0.0,  0.0, 0.0,  0.0, 0.0,
			   0.0, 0.0,  0.0, 0.0,  0.0, 0.0,  0.0,-1.0,
			   0.0, 0.0,  0.0, 0.0,  0.0,-1.0,  0.0, 0.0,

			   // gamma4gamma5 = - Gamma[7]
			   0.0,0.0,  0.0,0.0,   1.0,0.0,  0.0,0.0,
		           0.0,0.0,  0.0,0.0,   0.0,0.0,  1.0,0.0,
		          -1.0,0.0,  0.0,0.0,   0.0,0.0,  0.0,0.0,
			   0.0,0.0, -1.0,0.0,   0.0,0.0,  0.0,0.0,

			   // G8
			   0.0,0.0,  0.0,0.0,  1.0,0.0,  0.0,0.0,
			   0.0,0.0,  0.0,0.0,  0.0,0.0,  1.0,0.0,
			   1.0,0.0,  0.0,0.0,  0.0,0.0,  0.0,0.0,
			   0.0,0.0,  1.0,0.0,  0.0,0.0,  0.0,0.0,
			
			   // G9
			   0.0,0.0,  0.0,1.0,  0.0, 0.0,  0.0, 0.0,
			   0.0,1.0,  0.0,0.0,  0.0, 0.0,  0.0, 0.0,
			   0.0,0.0,  0.0,0.0,  0.0, 0.0,  0.0,-1.0,
			   0.0,0.0,  0.0,0.0,  0.0,-1.0,  0.0, 0.0,

			   // G10
			   0.0,0.0,  -1.0,0.0,   0.0,0.0,  0.0,0.0,
	      	           1.0,0.0,   0.0,0.0,   0.0,0.0,  0.0,0.0,
			   0.0,0.0,   0.0,0.0,   0.0,0.0,  1.0,0.0,
			   0.0,0.0,   0.0,0.0,  -1.0,0.0,  0.0,0.0,

			   // G11
			   0.0, 0.0,  0.0,0.0,  0.0,-1.0,  0.0,0.0,
			   0.0, 0.0,  0.0,0.0,  0.0, 0.0,  0.0,1.0,
		           0.0,-1.0,  0.0,0.0,  0.0, 0.0,  0.0,0.0,
			   0.0, 0.0,  0.0,1.0,  0.0, 0.0,  0.0,0.0,

			   // G12
                           0.0,1.0,  0.0, 0.0,  0.0, 0.0,  0.0,0.0,
			   0.0,0.0,  0.0,-1.0,  0.0, 0.0,  0.0,0.0,
			   0.0,0.0,  0.0, 0.0,  0.0,-1.0,  0.0,0.0,
			   0.0,0.0,  0.0, 0.0,  0.0, 0.0,  0.0,1.0,

			   // gamma2gamma5 = - G13
                           0.0,0.0,  0.0,0.0,  0.0,0.0, -1.0,0.0,
			   0.0,0.0,  0.0,0.0,  1.0,0.0,  0.0,0.0,
			   0.0,0.0, -1.0,0.0,  0.0,0.0,  0.0,0.0,
		           1.0,0.0,  0.0,0.0,  0.0,0.0,  0.0,0.0,

			   // G14
                           0.0, 0.0,  0.0, 0.0,  0.0, 0.0,  0.0,-1.0,
		           0.0, 0.0,  0.0, 0.0,  0.0,-1.0,  0.0, 0.0,
			   0.0, 0.0,  0.0,-1.0,  0.0, 0.0,  0.0, 0.0,
		           0.0,-1.0,  0.0, 0.0,  0.0, 0.0,  0.0, 0.0,

			   // G15
                           1.0,0.0,  0.0,0.0,   0.0,0.0,   0.0,0.0,
		   	   0.0,0.0,  1.0,0.0,   0.0,0.0,   0.0,0.0,
			   0.0,0.0,  0.0,0.0,  -1.0,0.0,   0.0,0.0,
			   0.0,0.0,  0.0,0.0,   0.0,0.0,  -1.0,0.0};
			
/*
 *do sign*Trace(gam1*G1*gam2*transpose(G2))
 *sign=1 or -1
 *using data in d_zero_mom_proj[D1x][D1y][D2x][D2y]
 *(momproj in short)
 *Explicitly: 
 *result=Sum_d1d2d3d4(gamm1[d1][d2]mompropj[d2][d3][d1][d4]gam2[d3][d4])
 */

/*?????if prop_dir!=3, DEV_I's actual polirization changes
 *when preparing gamm matrix,must take care of this
 *???New function IFloat *getGamMat(int pol_dir1, int pol_dir2=-1)
 *                      which get Gamm(pol_dir1) if pol_dir=-1
 *                                Gamm(pol_dir1)*Gam(pol_dir2) if pol_dir=0(X),1(Y),2(Z),3(T)
 *use pol=WspectQuarkdev::devDirToPolDir(i,d_prop_dir) to translate first
 */

//WspectExtendedMesons::traceDirac(IFloat* gam1,IFloat* gam2 ,int mesonId,int lclw){
//

//?? write the same one for WspectMesons too???
//result_p point to the correlator data entry(Complex number)
//sign is the sign of contribution to correlator of this trace term




CPS_END_NAMESPACE
