Copied from cps++/main/prop_gen/v1 in v5_0_8-RICC branch 
